(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();const ke=document.querySelector("#nav-link-1"),K=document.querySelector("#nav-link-2"),en=()=>{ke.textContent="Profile",ke.href="/semester-project-2-olemartin/home",K.addEventListener("click",()=>localStorage.clear()),K.href="/semester-project-2-olemartin/",K.textContent="Logout",document.title="Feed | AuctionHouse"},f=t=>{try{return JSON.parse(localStorage.getItem(t))}catch{return null}},tn=t=>localStorage.removeItem(t),b=(t,r)=>{localStorage.setItem(t,JSON.stringify(r))},I=t=>{localStorage.removeItem("location"),localStorage.setItem("location",JSON.stringify(t))},L={base:"https://api.noroff.dev/api/v1/auction/",register:"auth/register",login:"auth/login",account:"profiles/"+f("name")+"?_listings=true",listings:"listings",profiles:"profiles",editAvatar:"profiles/"+f("name")+"/media"},{base:Re}=L,j={"Content-Type":"application/json",Authorization:`Bearer ${f("auctionToken")}`},v={registerLogin:{method:"POST",headers:{"Content-Type":"application/json"},body:{}},getWithJwt:{method:"GET",headers:j},entry:{method:"POST",headers:j,body:{}},update:{method:"PUT",headers:j,body:{}},deleteOpt:{method:"DELETE",headers:j},react:{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("socialToken")}`}}},p=async(t,r)=>{try{return await(await fetch(Re+t,r)).json()}catch(e){console.error(e)}},n=(t,r)=>{const e=document.createElement(t);for(const o in r)e.setAttribute(o,r[o]);return e},Pe=n("div",{class:"mx-auto w-full mt-15  md:mx-auto md:w-1/2"}),_=n("form",{class:"mt-8 space-y-6 flex flex-col justify-center",method:"POST"}),le=_.cloneNode(!0),Y=n("div",{class:""}),nn=n("input",{class:"bg-logoBg relative block w-full appearance-none border border-auctionBlue px-3 py-2 focus:outline-auctionBrown",type:"email",placeholder:"email",name:"email",pattern:"^[\\w\\-.]+@(stud.)?noroff.no$",title:"use a @stud.noroff.no mail-adress",required:"required"}),Je=Y.cloneNode(!0);Y.append(nn);const sn=n("input",{class:"bg-logoBg relative block w-full appearance-none border border-auctionBlue px-3 py-2 focus:outline-auctionBrown",title:"uppercase, lowercase and (_) allowed",placeholder:"name",type:"text",name:"name",pattern:"[\\w]+$"}),on=Y.cloneNode(!0);Je.append(sn);const de=n("div",{class:""}),rn=n("input",{class:"bg-logoBg relative block w-full appearance-none border border-auctionBlue px-3 py-2 focus:outline-auctionBrown",type:"password",placeholder:"password",name:"password",minlength:"8",required:"required"});de.append(rn);const an=de.cloneNode(!0),ue=n("button",{type:"submit",class:"bg-auctionBlue text-almostWhite p-1  rounded-sm  mx-auto"});ue.innerHTML="Login";const Ue=ue.cloneNode(!0);Ue.innerHTML="Register";const V=n("div",{class:"bg-auctionBlue rounded text-center hidden",id:"login-success-alert"}),me=V.cloneNode(!0);me.innerHTML="Account successfully created";V.innerHTML="Login successful";const N=n("div",{class:"bg-auctionRed rounded text-center hidden",id:"login-warning-alert"});_.append(Y,de,ue,V,N);const _e=n("div",{class:"flex flex-col items-center justify-between mt-3"}),Ye=n("span",{class:"text-auctionGrey mx-auto"});Ye.innerHTML="OR";const cn=n("div",{class:"text-md mt-5 mx-auto"}),pe=n("a",{class:"text-almostWhite bg-auctionGrey opacity-50 p-1 ml-1 rounded-sm hover:text-indigo-500",href:"/semester-project-2-olemartin/register"});pe.innerHTML="Create an accocunt";cn.append(pe);_e.append(Ye,pe);Pe.append(_,_e);const Ve=n("div",{class:"mx-auto w-full mt-15  md:mx-auto md:w-1/2"}),Z=N.cloneNode(!0);le.append(Je,on,an,Ue,me,Z);Ve.append(le);const{login:ln}=L,{registerLogin:qe}=v,dn=()=>{_.addEventListener("submit",t=>{t.preventDefault();const r=new FormData(t.currentTarget),e=Object.fromEntries(r.entries()),{email:o}=e;qe.body=JSON.stringify(e),p(ln,qe).then(s=>{if(s.email===o){const{name:i,email:a,credits:l,avatar:c,accessToken:u}=s;console.log(s),V.classList.remove("hidden"),b("auctionToken",u),b("name",i),b("credits",l),b("email",a),b("avatar",c),I("/semester-project-2-olemartin/"),setTimeout(()=>{window.location.replace("/semester-project-2-olemartin/")},2e3)}else s.statusCode===401&&(N.classList.remove("hidden"),N.textContent=s.errors[0].message)})})},{register:un,login:mn}=L,{registerLogin:$}=v,pn=()=>{le.addEventListener("submit",t=>{t.preventDefault();const r=new FormData(t.currentTarget),e=Object.fromEntries(r.entries()),{name:o}=e;$.body=JSON.stringify(e),console.log($.body),p(un,$).then(s=>{s.name===o?(console.log(s),me.classList.remove("hidden"),setTimeout(()=>{p(mn,$).then(i=>{const{name:a,email:l,credits:c,avatar:u,accessToken:d}=i;b("auctionToken",d),b("name",a),b("credits",c),b("email",l),b("avatar",u),I("/semester-project-2-olemartin/"),setTimeout(()=>{window.location.replace("/semester-project-2-olemartin/")},2e3)})},2e3)):s.status==="Bad Request"&&(Z.classList.remove("hidden"),Z.textContent=s.errors[0].message)})})},k=()=>!(localStorage.getItem("auctionToken")===null||localStorage.getItem("auctionToken")==="undefined"),ze=document.querySelector("#navWithBar"),gn=document.querySelector("#bar"),fn=document.querySelector("#zoomglass"),Ke=document.querySelector("#navWithSearch"),Qe=document.querySelector("#filters"),Xe=()=>{gn.addEventListener("click",t=>{t.stopImmediatePropagation(),ze.classList.toggle("hidden"),Qe.classList.add("hidden"),Ke.classList.add("hidden")})},Ze=()=>{fn.addEventListener("click",t=>{t.stopImmediatePropagation(),Ke.classList.toggle("hidden"),ze.classList.add("hidden"),Qe.classList.toggle("hidden")})},bn=document.querySelector("#itemContainer"),hn=()=>{bn.insertAdjacentElement("beforeend",Pe)},xn=document.querySelector("#itemContainer"),vn=()=>{xn.insertAdjacentElement("beforeend",Ve)},Ie=window.location.href,et=()=>{Ie.includes("login")?(hn(),dn()):Ie.includes("register")?(vn(),pn()):k()===!0&&(Xe(),Ze(),en())},ge=()=>{document.querySelectorAll(".fa-expand").forEach(r=>{r.addEventListener("click",e=>{const o=document.createElement("div");o.setAttribute("class","modal"),document.querySelector("main").append(o);const i=e.currentTarget.nextElementSibling.nextElementSibling.cloneNode(!0);o.append(i),o.addEventListener("click",()=>{document.querySelector(".modal").remove()})})})},tt=1e3,F=tt*60,q=F*60,nt=q*24,h=t=>{const r=new Date(t),e=new Date;return r-e},yn=(t,r)=>{const e=Math.floor(h(t)%nt/q);let o;return r.length>0?o=r[r.length-1].amount:o="0",e<0?'<span class="bg-auctionRed text-auctionGrey">SOLD</span>':"<span>"+e+" hours left</span><span>Bid:"+o+"$</span>"},Ln=(t,r)=>{const e=Math.floor(h(t)%q/F);let o;return r.length>0?o=r[r.length-1].amount:o="0",e<0?'<span class="bg-auctionRed text-auctionGrey">SOLD</span>':"<span>"+e+" min left</span><span>Bid:"+o+"$</span>"},wn=t=>{let r=[...t];for(let e=0;e<r.length;e++){let o=!1;for(let s=0;s<r.length;s++)if(r[s]>r[s+1]){let i=r[s];r[s]=r[s+1],r[s+1]=i,o=!0}if(!o)return r}return r},ee=t=>`
  <div
    class="relative aspect-square lg:aspect-square flex flex-col items-center mb-2 shrink justify-between bg-almostWhite overflow-auto hover:overflow-scrollborder-5">
    <i class="absolute fa-sharp fa-solid fa-expand top-5 right-5 text-black fa-lg" id="${t.id}"></i>
    <p class="absolute text-almostWhite p-1 bg-auctionBrown  left-0 bottom-20">${t.title}</p>
    <img 
      src="${t.media[0]}"
      alt="" class="itemImage object-top  object-cover h-2/3 shrink min-w-full img${t.id}">
    <div class="flex text-auctionBlue min-w-full justify-around">
    <div class="flex flex-col m-0 p-0">
    ${yn(t.endsAt,t.bids)}
    </div>
    <a href="/semester-project-2-olemartin/item?id=${t.id}" class="bg-auctionGrey p-1 mb-5 rounded-sm text-almostWhite">view item</a>
    </div>
  </div>
    `,Tn=document.querySelector("#listingsFeed"),Hn=async t=>{await p("listings?_bids=true&sort=created&sortOrder=desc").then(r=>{const e=r.filter(o=>o.bids.length>0);for(let o=0;o<e.length;o++){const s=e[o];if(o===10)break;Tn.insertAdjacentHTML("beforeend",ee(s))}}),ge()},st=(t,r)=>{const e=document.querySelector(".counterBox"+t),o=n("div",{class:"time flex flex-col"}),s=n("div",{class:"time flex flex-col"}),i=n("div",{class:"time flex flex-col"}),a=n("h2",{class:"mx-auto text-auctionRed"}),l=n("h2",{class:"mx-auto text-auctionRed"}),c=n("h2",{class:"mx-auto text-auctionRed"}),u=n("small",{class:"mx-auto text-auctionRed"}),d=n("small",{class:"mx-auto text-auctionRed"}),x=n("small",{class:"mx-auto text-auctionRed"});u.innerHTML="hours",d.innerHTML="minutes",x.innerHTML="seconds",o.append(a),o.append(u),s.append(l),s.append(d),i.append(c),i.append(x),e.append(o),e.append(s),e.append(i),setInterval(()=>{c.innerHTML=Math.floor(h(r)%F/tt),l.innerHTML=Math.floor(h(r)%q/F),a.innerHTML=Math.floor(h(r)%nt/q)},1e3)},Bn=(t,r,e)=>{t.forEach((o,s)=>{const i=n("button",{class:"border bg-auctionBlue aspect-square flex h-7 mx-3 place-content-center items-center border-2 border-almostWhite drop-shadow-md font-bold"});i.innerHTML=s+1,e.append(i),i.addEventListener("click",l=>{document.querySelector(".bg-auctionBlue").classList.add("bg-slate-400"),document.querySelector(".bg-auctionBlue").classList.remove("bg-auctionBlue"),l.currentTarget.classList.remove("bg-slate-400"),l.currentTarget.classList.add("bg-auctionBlue"),document.querySelector(".currentImg").classList.add("hidden"),document.querySelector(".currentImg").classList.remove("currentImg"),document.getElementById(l.currentTarget.innerHTML).classList.remove("hidden"),document.getElementById(l.currentTarget.innerHTML).classList.add("currentImg")});const a=n("img",{class:" object-top  object-cover h-2/3 shrink w-4/5 mx-auto currentImg aspect-square drop-shadow-md hidden",id:s+1});s===0&&a.classList.remove("hidden"),a.src=o,r.append(a),s!==0&&i.classList.add("bg-slate-400")})},{entry:Ae}=v,Sn=(t,r)=>{const e=new FormData(t.currentTarget),o=Object.fromEntries(e.entries()),{amount:s}=o;Ae.body=JSON.stringify({amount:Number(s)}),console.log(o),console.log(r),p(`listings/${r}/bids`,Ae).then(l=>{console.log(l)});const a=f("credits")-Number(s);b("credits",a)},Mn=(t,r,e,o,s,i,a)=>{t.addEventListener("click",l=>{const c=document.createElement("div");c.setAttribute("class","modal"),c.classList.add("bg-auctionGrey"),document.querySelector("main").append(c);const u=w;c.append(u),ot.innerHTML=r,ct.innerHTML="Your bid: "+e+"$",rt.src=i,it.innerHTML="<span class='underline underline-offset-2 '>current status</span>"+Ln(o,s),at.innerHTML="Your credits "+f("credits")+"$",lt.value=e,fe.addEventListener("click",()=>{document.querySelector(".modal").remove()}),document.getElementById("modalSubmit").addEventListener("submit",d=>{d.preventDefault(),d.stopImmediatePropagation(),Sn(d,a),te.classList.remove("bg-orange-300"),te.classList.add("bg-green-200"),setTimeout(()=>{document.location.replace("/semester-project-2-olemartin/")},1500)})})},w=n("form",{class:"bg-almostWhite w-4/5 md:w-1/2 h-2/3 mx-auto justify-around flex flex-col my-2 p-5 relative bg-auctionWhite",id:"modalSubmit"}),fe=n("i",{class:" text-auctionRed absolute p-4 aspect-square right-0 top-0 h-7"});fe.innerHTML="<i class='fa-solid fa-xmark fa-xl'></i>";const ot=n("h2",{class:"text-logoBg font-bold w-full text-xl mx-auto my-2 p-1 flex place-content-center "}),rt=n("img",{class:"object-top  object-cover h-2/3 shrink w-4/5 mx-auto currentImg aspect-square drop-shadow-md"}),it=n("h4",{class:" py-3 mx-auto text-lg flex place-content-center flex-col text-logoBg font-bold"}),at=n("h4",{class:"py-3 absolute left-0 top-1  text-logoBg font-bold"}),ct=n("h3",{class:"w-full py-3 mx-auto text-lg flex place-content-center text-logoBg font-bold"}),lt=n("input",{id:"bidInput",name:"amount",type:"number",class:"bg-almostWhite border border-2 w-10 bg-white text-auctionGrey hidden",placeholder:"$"}),te=n("input",{type:"submit",value:"Confirm",class:"border text-lg font-bold border-radius-sm bg-orange-300 text-auctionBrown py-2 px-4"});w.append(ot);w.append(fe);w.append(rt);w.append(it);w.append(at);w.append(ct);w.append(lt);w.append(te);n("input",{type:"submit",value:"Confirm",class:"border border-radius-sm bg-white text-auctionBlue px-2"});n("div",{class:"w-1/2 shrink flex justify-end p-2 gap-1"});const En=n("label",{for:"bidInput",class:" text-auctionBrown text-base w-1/2 flex place-content-center items-center"});En.textContent="Place a bid";const kn=(t,r,e,o,s,i,a,l)=>{t.addEventListener("keyup",c=>{c.stopImmediatePropagation();const u=c.currentTarget.value;u-1<r?(e.classList.remove("bg-white"),e.classList.add("bg-red-200"),e.setAttribute("disabled","disabled"),t.setAttribute("title","amount to low")):(e.classList.add("bg-white"),e.classList.remove("bg-red-200"),e.removeAttribute("disabled"),t.removeAttribute("title"),Mn(e,o,u,s,i,a,l))})},dt=t=>{t.addEventListener("click",()=>{window.location.href="/semester-project-2-olemartin/",I("/semester-project-2-olemartin/")}),t.innerHTML="&#x2190; back"},qn=(t,r,e)=>{e.length===0&&(r.remove(),t.remove()),e.forEach(o=>{r.insertAdjacentHTML("beforeend",`
        <div class="w-full text-auctionGrey flex">
        <p class="w-full text-auctionGrey text-center">${o.bidderName}</p>
        <p class="w-full text-auctionGrey text-center">${o.amount} $</p>
        </div>
        `)}),t.addEventListener("click",o=>{r.classList.toggle("hidden")})},In=n("div",{class:"counterBox w-full grid grid-cols-3  my-5 p-0"}),ut=n("p",{class:"text-auctionGrey"}),ne=n("p",{class:"text-auctionGrey"}),mt=n("div",{class:"w-full bg-green-200 flex justify-around md:w-3/4 mx-auto my-2  flex-wrap "});mt.append(ut,ne);const be=n("button",{class:"px-1 mx-auto text-auctionGrey rounded-sm text-sm bg-auctionYellow mx-auto"});be.innerHTML="View all bids &darr;";const pt=n("div",{class:"text-auctionGrey w-full hidden bg-auctionYellow w-1/2 mx-auto",id:"bid-section"}),gt=n("input",{id:"bidInput",name:"amount",type:"number",class:"bg-almostWhite border border-2 w-10 bg-white text-auctionGrey",placeholder:"$"}),ft=n("input",{type:"button",value:"SUBMIT",class:"border border-radius-sm bg-white text-auctionBlue px-2"}),he=n("div",{class:"w-1/2 shrink flex justify-end p-2 gap-1"}),xe=n("label",{for:"bidInput",class:" text-auctionBrown text-base w-1/2 flex place-content-center items-center"});xe.textContent="Place a bid";const bt=n("div",{class:"bg-auctionBlue w-full bg-opacity-50 md:w-3/4 mx-auto flex my-2 p-1"}),ht=n("div",{class:"relative flex flex-col justify-between bg-almostWhite p-3"}),D=n("div",{class:""}),xt=n("h1",{class:"text-auctionBlue block text-xl mx-auto flex place-content-center"}),se=n("p",{class:"text-auctionBrown mx-auto"}),ve=n("div",{class:"flex place-content-center align-center my-5 flex-wrap"}),vt=n("small",{class:"text-auctionGrey w-full flex place-content-center"});vt.innerHTML="images";ve.append(vt);const yt=n("div",{class:"bg-white p-5 mx-auto flex flex-col   md:w-4/5 border border-auctionBrown rounded-lg drop-shadow-sm my-10"});ht.append(se,yt);const ye=n("div",{class:"mx-auto my-5 md:w-4/5 flex flex-wrap divide-x divide-slate-200"}),Lt=n("h3",{class:"text-md text-auctionBlue w-full"});Lt.innerHTML="Description";const wt=n("p",{class:"text-auctionGrey w-1/2 p-1"});ye.append(Lt);const Tt=n("p",{class:"text-auctionGrey w-1/2 p-1"});ye.append(wt,Tt);he.append(gt,ft);bt.append(xe,he);yt.append(xt,ve,D,In,mt,be,pt,bt,ye);const je=document.querySelector("#itemContainer"),An=document.querySelector("#listingsFeed"),jn=document.querySelector("main"),$n=document.querySelector("#filters"),$e=document.querySelector("#listingHeader"),Gn=()=>{An.innerHTML="",je.innerHTML="",$e.innerHTML="",$n.remove(),document.title="Item | AuctionHouse",jn.classList.remove("bg-auctionBg");const r=`listings/${f("location").substring(8)}?_seller=true&_bids=true`;dt($e),je.append(ht),p(r).then(e=>{var a,l;e.media.length>0?Bn(e.media,D,ve):(D.innerHTML="No images added to this listing",D.classList.add("text-auctionGrey"));const o=e.endsAt;xt.innerHTML=e.title,k()?se.innerHTML=`<a href="/semester-project-2-olemartin/user?${e.seller.name}"><span class="text-auctionGrey">seller: </span class="font-bold text-lg">${e.seller.name}</a>`:se.innerHTML=`<a href="#">${e.seller.name} <span class="text-auctionGrey">(log in to visit ) </span></a>`,h(e.endsAt)>0&&st("",o),ut.innerHTML="Highest bid",e.bids.length>0?ne.innerHTML=e.bids[e.bids.length-1].bidderName+": "+e.bids[e.bids.length-1].amount+"$":ne.innerHTML=0+"$",wt.innerHTML=e.description,Tt.innerHTML="tags: "+e.tags.toString(""),h(e.endsAt)<0&&(he.innerHTML="Not possible to bid on this item");const i=(l=(a=e.bids[e.bids.length-1])==null?void 0:a.amount)!=null?l:0;k()?kn(gt,i,ft,e.title,e.endsAt,e.bids,e.media[0],e.id):xe.innerHTML="log in to bid",qn(be,pt,e.bids)})},{entry:Ge}=v,{listings:Cn}=L,Wn=t=>{const r=new FormData(t.currentTarget),e=Object.fromEntries(r.entries()),{date:o,tags:s,title:i,description:a}=e,c=new Date(o).toJSON();let u=[],d=s.split(",");document.querySelectorAll("[name='media'").forEach(T=>{T.value.length>0&&u.push(T.value)}),Ge.body=JSON.stringify({title:i,description:a,tags:d,media:u,endsAt:c}),p(Cn,Ge).then(T=>{console.log(T)})},m=n("form",{class:" hidden mt-8 bg-logoBg p-3 relative flex flex-col justify-center mx-auto md:w-2/3 w-full",id:"newItem",method:"post",required:"required"}),Ht=n("small",{class:"text-almostWhite mx-auto mt-2"});Ht.innerHTML="Title";const Dn=n("input",{class:"bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"text",name:"title",id:"titleInput",placeholder:"Title",required:"required"}),Bt=n("small",{class:"text-almostWhite mx-auto mt-2"});Bt.innerHTML="tags";const Nn=n("input",{class:"bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"text",name:"tags",id:"tagsInput",placeholder:"tags"}),St=n("small",{class:"text-almostWhite mx-auto mt-2"});St.innerHTML="Description";const Fn=n("input",{class:"bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"text",name:"description",id:"descriptionInput",placeholder:"description"}),Mt=n("small",{class:"text-almostWhite mx-auto mt-2"});Mt.innerHTML="Image URL's";const On=n("input",{class:"bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"url",name:"media",id:"mediaInput",placeholder:"media URL"}),oe=n("input",{class:"hidden bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"url",name:"media",id:"mediaInput1",placeholder:"media URL",disabled:"disabled"}),re=n("input",{class:"hidden bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"url",name:"media",id:"mediaInput2",placeholder:"media URL",disabled:"disabled"}),ie=n("input",{class:"hidden bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"url",name:"media",id:"mediaInput3",placeholder:"media URL",disabled:"disabled"}),Rn=n("input",{class:"bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"datetime-local",name:"date",id:"dateInput",placeholder:"ends at",required:"required"}),Pn=n("input",{class:"mt-2 rounded-none py-3 bg-auctionBlue",type:"submit",placeholder:"submit"}),Le=n("button",{class:"text-sm p-0 m-0 border rounded-none mx-auto px-1 mt-1",type:"button"});Le.innerHTML="Add photos &#8595";Le.addEventListener("click",t=>{oe.classList.remove("hidden"),re.classList.remove("hidden"),ie.classList.remove("hidden"),oe.removeAttribute("disabled"),re.removeAttribute("disabled"),ie.removeAttribute("disabled"),t.currentTarget.classList.add("hidden")});m.append(Ht);m.append(Dn);m.append(Bt);m.append(Nn);m.append(St);m.append(Fn);m.append(Mt);m.append(On);m.append(oe);m.append(re);m.append(ie);m.append(Le);m.append(Rn);m.append(Pn);const{deleteOpt:Jn}=v,{listings:Un}=L,_n=t=>{t.addEventListener("click",()=>{fetch(Re+Un+"/"+t.id,Jn),setTimeout(()=>{window.location.reload()},500)})},{update:Ce}=v,{listings:Yn}=L,Vn=(t,r)=>{const e=new FormData(t.currentTarget),o=Object.fromEntries(e.entries()),{tags:s,title:i,description:a}=o;let l=[],c=s.split(",");t.currentTarget.querySelectorAll("[name='media'").forEach(d=>{d.value.length>0&&l.push(d.value)}),Ce.body=JSON.stringify({title:i,description:a,tags:c,media:l}),p(Yn+"/"+r,Ce).then(d=>{console.log(d)})},{listings:zn}=L,{getWithJwt:Kn}=v,Qn=t=>{t.addEventListener("click",r=>{r.stopImmediatePropagation();const e=n("i",{class:"fa-solid fa-xmark fa-xl text-almostWhite absolute p-4 aspect-square right-0 top-0 h-7 hover:bg-auctionGreen"});g.append(e),g.classList.remove("hidden"),B.classList.add("modal"),B.classList.remove("hidden");const o=g.dateInput;o.remove();const s=g.querySelector("button");s.remove();const i=g.tags,a=Array.from(g.media);g.querySelectorAll(".hidden").forEach(c=>{c.classList.remove("hidden")}),p(zn+"/"+r.currentTarget.id,Kn).then(c=>{g.title.value=c.title,g.description.value=c.description,c.media.forEach((d,x)=>{a[x].value=d}),i.value=c.tags.join(", ")}),e.addEventListener("click",()=>{e.remove(),g.append(o),g.append(s),g.classList.add("hidden"),B.classList.remove("modal"),B.classList.add("hidden")}),g.addEventListener("submit",c=>{c.preventDefault(),Vn(c,t.id),setTimeout(()=>{document.location.replace("/semester-project-2-olemartin/")},1e3)})})},Et=(t,r=0)=>{let e;return function(...o){clearTimeout(e),e=setTimeout(()=>t.apply(this,o),r)}},{editAvatar:Xn}=L,{update:We}=v,Zn=t=>{t.addEventListener("click",r=>{r.stopImmediatePropagation(),H.classList.remove("hidden"),H.classList.add("modal");const e=n("i",{class:"fa-solid fa-xmark fa-xl text-almostWhite absolute p-4 aspect-square right-5 top-5 h-7 hover:bg-auctionGreen"});H.append(E,e);const o=E.media,s=E.avatar;e.addEventListener("click",()=>{H.classList.add("hidden"),H.classList.remove("modal")}),o.addEventListener("input",Et(i=>{s.src=i.target.value},1e3)),E.addEventListener("submit",i=>{i.preventDefault(),We.body=JSON.stringify({avatar:o.value}),p(Xn,We).then(a=>{console.log(a),tn("avatar"),b("avatar",a.avatar),setTimeout(()=>{document.location.replace("/semester-project-2-olemartin/")},1e3)})})})},kt=n("div",{class:"w-full  lg:w-2/4 sm:w-3/4 self-center flex flex-wrap"}),qt=n("img",{class:"w-1/3 sm:w-1/2 apect-square mx-auto border rounded-lg max-w-lg"}),It=n("div",{class:"w-2/3 sm:w-1/2 text-auctionGrey sm:grid sm:grid-rows-4 p-2"}),At=n("h2",{class:" text-auctionGrey text-xl "}),we=n("button",{class:"border bg-auctionGrey text-almostWhite h-8 m-0 text-sm w-1/2 self-end"});we.innerHTML="Edit avatar";Zn(we);const jt=n("p",{class:" text-auctionGrey"}),$t=n("p",{class:" text-auctionGrey"});It.append(At,jt,$t,we);const Gt=n("div",{class:"w-full   my-5"}),Te=n("button",{class:" px-3 py-2 bg-auctionGreen rounded mx-auto border-none w-full"});Gt.append(Te,m);Te.innerHTML="Add listing";kt.append(qt,It,Gt);const Ct=n("div",{class:"py-20"}),Wt=n("h2",{class:"text-lg text-auctionGrey "});Wt.innerHTML="Your listings";const Dt=n("div",{class:"w-full flex justify-start"}),O=n("button",{class:"rounded-xl bg-auctionBlue  mx-1 md:w-40 py-1 w-1/4"});O.innerHTML="Acitve";const R=n("button",{class:"rounded-xl bg-logoBg mx-1 py-1 md:w-40 w-1/4  "});R.innerHTML="All";Dt.append(O,R);Ct.append(Wt,Dt);const Q=(t,r,e,o,s)=>{const i=n("div",{class:"w-full grid grid-rows-4 sm:grid-rows-1 sm:grid-cols-4 relative sm:h-40 border rounded border-auctionBrown border-1 my-2"}),a=n("img",{class:"h-20 w-20 aspect-square object-cover m-auto"});a.src=t;const l=n("div",{class:"flex flex-col justify-around"}),c=n("p",{class:"text-auctionGrey m-auto"});c.innerHTML=r;const u=n("p",{class:"text-auctionGrey m-auto"});u.innerHTML=e,l.append(c,u);const d=n("div",{class:"flex flex-col justify-around p-3"}),x=n("button",{class:"bg-auctionBlue text-auctionGrey w-1/2 mx-auto my-1",id:s});Qn(x),x.innerHTML="Update";const T=n("button",{class:"bg-auctionRed text-auctionGrey w-1/2 mx-auto my-1",id:s});T.innerHTML="Delete",_n(T),d.append(x,T);const Ee=n("div",{class:"flex p-3"}),z=n("a",{class:"text-auctionGrey m-auto bg-veryLightGrey h-1/2 w-full border rounded-lg items-center flex place-content-center"});return z.href=o,z.innerHTML="Visit",Ee.append(z),i.append(a,l,d,Ee),i},Nt=t=>h(t)<0?"<span class='bg-red-300 bg-opacity-30 p-2 text-auctionGrey'>FINISED</span>":"<span class='bg-auctionGreen bg-opacity-30 p-2 text-auctionGrey'>ACTIVE</span>",es=t=>!(h(t)<0),E=n("form",{id:"avatarForm",class:"w-2/3 h-2/3 rounded-sm bg-logoBg flex flex-col align-items-center relative"}),ts=n("input",{class:" bg-almostWhite my-2 rounded p-1 text-black ",type:"url",name:"media",id:"avatarInput",placeholder:"avatar URL"}),Ft=n("button",{type:"submit",class:"bg-auctionBlue rounded-none w-40 mx-auto my-5"});Ft.innerHTML="Update";const Ot=n("img",{class:"w-1/2 rounded-lg m-2",name:"avatar"});Ot.src=f("avatar");E.append(Ot,ts,Ft);const De=(t,r,e,o)=>{t.remove(),t.innerHTML="",r.append(t),e.forEach(s=>{t.insertAdjacentElement("beforeend",o(s.media[0],s.title,Nt(s.endsAt),`/semester-project-2-olemartin/item?id=${s.id}`,s.id))})},{account:ns}=L,{getWithJwt:ss}=v,os=document.querySelector("#listingHeader"),G=document.querySelector("#itemContainer"),C=n("div",{class:""}),B=n("div",{class:"w-full aspect-square hidden"}),g=m.cloneNode(!0),H=n("div",{class:"w-full aspect-square hidden"}),rs=async()=>{document.body.append(B,H),G.classList.add("min-h-screen"),document.title="Profile | AuctionHouse",os.innerHTML="Your details",g.id="updateForm",B.append(g),G.append(kt,Ct,C);const t=[],r=[];await p(ns,ss).then(e=>{console.log(e),qt.src=e.avatar,At.innerHTML=e.name,jt.innerHTML=e.email,$t.innerHTML="Your wallet "+e.credits+"$",e.listings.forEach(o=>{C.insertAdjacentElement("beforeend",Q(o.media[0],o.title,Nt(o.endsAt),`/semester-project-2-olemartin/item?id=${o.id}`,o.id)),es(o.endsAt)&&t.push(o),r.push(o)})}),O.append("("+t.length+")"),R.append("("+r.length+")"),O.addEventListener("click",()=>{De(C,G,t,Q)}),R.addEventListener("click",()=>{De(C,G,r,Q)}),Te.addEventListener("click",e=>{m.classList.toggle("hidden")}),m.addEventListener("submit",e=>{e.preventDefault(),Wn(e),setTimeout(()=>{document.location.replace("/semester-project-2-olemartin/")},500)})},He=n("div",{class:"w-full flex lg:w-2/4 md:w-3/4 self-center"}),Rt=n("img",{class:"w-1/2 apect-square mx-auto border rounded-lg max-w-lg"}),Pt=n("h2",{class:"w-1/2 mx-auto text-auctionGrey text-xl flex items-center place-content-center"});He.append(Rt);He.append(Pt);const ae=n("div",{class:"py-20"}),Jt=n("h2",{class:"text-lg text-auctionGrey"});ae.append(Jt);const is=(t,r,e,o)=>{const s=n("a",{class:"w-full grid grid-cols-3 relative h-24 items-center border rounded border-auctionBrown my-2 place-content-center"});s.href=t;const i=n("img",{class:"h-12 w-12 aspect-square object-cover mx-auto"});i.src=r;const a=n("p",{class:"text-auctionGrey"});a.innerHTML=e;const l=n("p",{class:"text-auctionGrey"});return l.innerHTML=o,s.append(i,a,l),s},Ne=t=>h(t)<0?"<span class='bg-red-300 bg-opacity-30 p-2 text-auctionGrey'>FINISED</span>":"<span class='bg-auctionGreen bg-opacity-30 p-2 text-auctionGrey'>ACTIVE</span>",ce=n("div",{class:"py-10"}),Ut=n("h2",{class:"text-lg text-auctionGrey "});ce.append(Ut);const as=(t,r,e)=>{const o=n("a",{class:"w-full grid grid-cols-3 relative h-20 items-center border rounded border-auctionBrown my-2 place-content-center"});o.href=t;const s=n("p",{class:"text-auctionGrey"});s.innerHTML=r;const i=n("p",{class:"text-auctionGrey"});return i.innerHTML=e,o.append(s,"-",i),o},cs=document.querySelector("#itemContainer"),ls=document.querySelector("#listingHeader"),{getWithJwt:Fe}=v,ds=()=>{dt(ls);const t=f("location").substring(5),r=`profiles/${t}?_listings=true `,e=`profiles/${t}/bids?_listings=true`;cs.append(He,ae,ce),p(r,Fe).then(o=>{Rt.src=o.avatar,Pt.innerHTML=o.name,Jt.innerHTML=o.name+"'s listings",o.listings.forEach(s=>{ae.insertAdjacentElement("beforeend",is(`/semester-project-2-olemartin/item?id=${s.id}`,s.media[0],s.title,Ne(s.endsAt)))})}),p(e,Fe).then(o=>{o.length>0&&(Ut.innerHTML=o[0].bidderName+" made bid's on these listings",o.forEach(s=>{ce.insertAdjacentElement("beforeend",as(`/semester-project-2-olemartin/item?id=${s.listing.id}`,s.listing.title,Ne(s.listing.endsAt)))}))})},_t=()=>{f("location").includes("item")?Gn():f("location").includes("user")&&k()?ds():f("location").includes("home")?rs():document.querySelector("#listingsFeed")&&f("location").includes("semester")&&Hn()},Yt=()=>{document.querySelector("#listingsFeed")&&(Xe(),Ze())},P=n("button",{class:"text-almostWhite bg-logoBg w-1/4  rounded-none px-1 border-none mx-auto w-30 enabled:hover:outline-none",id:"filter-link-1"});P.innerHTML="Newest";const J=n("button",{class:"text-almostWhite bg-logoBg w-1/4  rounded-none px-1 border-none mx-auto w-30 enabled:hover:outline-none",id:"filter-link-2"});J.innerHTML="Expiring today";const Be=n("nav",{class:""}),Vt=n("div",{class:"flex self-center"}),zt=n("p",{class:"text-logoBg m-auto"});zt.innerHTML="sort by";const Se=n("div",{class:"flex flex-col md:flex-row md:pb-0 pb-0 gap-2"});Vt.append(zt);Se.append(J);Se.append(P);Be.append(Vt);Be.append(Se);const U=n("button",{class:"px-5 border border-1 text-logoBg py-2 mx-auto block"});U.innerHTML="Next";const S=n("button",{class:"border border-logoBg py-1 mx-2 w-20 enabled:hover:outline-none text-black"});S.innerHTML="titles";const M=n("button",{class:"border border-logoBg py-1 mx-2 w-20 enabled:hover:outline-none text-black"});M.innerHTML="users";const A=n("button",{class:"border border-logoBg py-1 mx-2 w-20 enabled:hover:outline-none text-black"});A.innerHTML="tags";const Kt=(t,r,e,o)=>{const s=n("a",{class:"w-full grid grid-cols-3 relative h-24 items-center border rounded border-auctionBrown my-2 place-content-center"});s.href=t;const i=n("img",{class:"h-12 w-12 aspect-square object-cover mx-auto"});i.src=r;const a=n("p",{class:"text-auctionGrey"});a.innerHTML=e;const l=n("p",{class:"text-auctionGrey"});return l.innerHTML=o,s.append(i,a,l),s},Qt=t=>h(t)<0?"<span class='bg-red-300 bg-opacity-30 p-2 text-auctionGrey'>FINISED</span>":"<span class='bg-auctionGreen bg-opacity-30 p-2 text-auctionGrey'>ACTIVE</span>",us=(t,r,e)=>{const o=n("a",{class:"w-full grid grid-cols-2 relative h-24 items-center border rounded border-auctionBrown my-2 place-content-center"});o.href="/semester-project-2-olemartin/user/"+t;const s=n("img",{class:"h-12 w-12 aspect-square object-cover mx-auto"});s.src=r;const i=n("p",{class:"text-auctionGrey"});return i.innerHTML=e,o.append(s,i),o},ms=document.querySelector("#listingsFeed"),ps=document.querySelector("#itemContainer"),gs=document.querySelector("#searchForm"),W=document.querySelector("#filters"),fs=()=>{gs.addEventListener("input",()=>{ms.innerHTML="",ps.innerHTML=`<div class="h-screen flex items-start place-content-center">
            <div class="relative w-24 h-24 animate-spin rounded-full bg-gradient-to-r from-auctionGreen via-logoBg to-auctionBlue ">
            <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-20 h-20 bg-gray-200 rounded-full border-2"></div>
            </div>
            </div>`,W.innerHTML="",W.append(S,A,M),W.classList.remove("md:columns-2","md:block"),W.classList.add("md:flex","place-content-center")})},X=document.querySelector("#listingsFeed");document.querySelector("#filter-link-1");const bs=document.querySelector("#listingHeader"),Xt=async(t,r)=>{let e=t;X.innerHTML="",bs.innerHTML="Recently added items",await p("listings?_bids=true&sort=created&sortOrder=desc").then(s=>{const i=s.filter(a=>a.media[0]!==void 0);for(e;e<r;e++){const a=i[e];ee(a),X.insertAdjacentHTML("beforeend",ee(a))}}),ge(),X.insertAdjacentElement("afterend",U);let o=0;U.addEventListener("click",s=>{s.stopImmediatePropagation(),o++,Xt(14*o,28*o)})},hs=t=>`
    <div
    class="relative aspect-square lg:aspect-square flex flex-col items-center mb-2 shrink justify-between bg-almostWhite overflow-auto hover:overflow-scrollborder-5">
    <i class="absolute fa-sharp fa-solid fa-expand top-5 right-5 text-black fa-lg" id="${t.id}"></i>
    <p class="absolute text-almostWhite p-1 bg-auctionBrown  left-0 bottom-20">${t.title}</p>
    <img 
      src="${t.media[0]}"
      alt="" class="itemImage object-top  object-cover h-2/3 shrink min-w-full img${t.id}">
    <div class="flex text-auctionBlue min-w-full justify-around counterB">
    <div class="grid grid-cols-3  m-0 p-0 w-1/2 counterBox${t.id}">
    </div>
    <a href="/semester-project-2-olemartin/item?id=${t.id}" class="bg-auctionGrey p-1 mb-5 rounded-sm text-almostWhite">view item</a>
    </div>
  </div>
    `,Oe=document.querySelector("#listingsFeed"),xs=document.querySelector("#listingHeader"),vs=async(t,r)=>{let e=t;Oe.innerHTML="",xs.innerHTML="Expires today",await p("listings?_bids=true&sort=created&sortOrder=desc").then(o=>{const s=o.filter(c=>h(c.endsAt)<864e5&&h(c.endsAt)>0),i=[];s.forEach(c=>{i.push(c.endsAt)});const a=wn(i),l=[];for(let c=0;c<a.length;c++){const u=a[c];for(let d=0;d<s.length;d++){let x=s[d];s[d].endsAt===u&&!l.includes(s[d])&&l.push(x)}}for(e=0;e<r;e++){const c=l[e];if(c===void 0)break;const u=c.endsAt,d=c.id;Oe.insertAdjacentHTML("beforeend",hs(c)),st(d,u)}}),ge()},y=document.querySelector("#itemContainer"),Me=document.querySelector("#listingHeader"),ys=t=>{S.addEventListener("click",r=>{r.currentTarget.classList.add("bg-auctionBlue"),A.classList.remove("bg-auctionBlue"),M.classList.remove("bg-auctionBlue"),y.innerHTML="",setTimeout(()=>{(y.innerHTML.includes("-translate-x-1/2")||y.innerHTML==="")&&(y.innerHTML="<p class='font-bold text-black mx-auto'>No results. <a href='./'>Go back</a></p>")},1500),t.forEach(e=>{y.insertAdjacentElement("beforeend",Kt(`/semester-project-2-olemartin/item?id=${e.id}`,e.media[0],e.title,Qt(e.endsAt)))})}),S.click(),Me.innerHTML="Search by title"},Ls=t=>{A.addEventListener("click",r=>{Me.innerHTML="Search by tags",r.currentTarget.classList.add("bg-auctionBlue"),S.classList.remove("bg-auctionBlue"),M.classList.remove("bg-auctionBlue"),y.innerHTML="",t.forEach(e=>{y.insertAdjacentElement("beforeend",Kt(`/semester-project-2-olemartin/item?id=${e.id}`,e.media[0],e.title,Qt(e.endsAt)))})})},ws=t=>{M.addEventListener("click",r=>{Me.innerHTML="Search by user",r.currentTarget.classList.add("bg-auctionBlue"),S.classList.remove("bg-auctionBlue"),A.classList.remove("bg-auctionBlue"),y.innerHTML="",t.forEach(e=>{y.insertAdjacentElement("beforeend",us(e.name,e.avatar,e.name))})})},{getWithJwt:Ts}=v,Hs=document.querySelector("#searchForm"),Bs=()=>{Hs.addEventListener("input",Et(t=>{Ss(t)},1e3))},Ss=t=>{p("listings").then(r=>{const e=r.filter(s=>Boolean(s.tags.map(a=>a.toLowerCase()).filter(a=>a.includes(t.target.value)).length)),o=r.filter(s=>s.title.includes(t.target.value));ys(o),Ls(e)}),k()?p("profiles",Ts).then(r=>{const e=r.filter(o=>o.name.includes(t.target.value));ws(e),console.log(r)}):M.remove()},Ms=document.querySelector("#filters"),Zt=()=>{Ms.insertAdjacentElement("beforeend",Be),P.addEventListener("click",t=>{document.querySelector("#itemContainer")&&document.querySelector("#itemContainer").remove(),Xt(0,14),t.currentTarget.classList.add("bg-auctionBlue"),J.classList.remove("bg-auctionBlue")}),J.addEventListener("click",t=>{U.remove(),document.querySelector("#itemContainer")&&document.querySelector("#itemContainer").remove(),vs(0,14),t.currentTarget.classList.add("bg-auctionBlue"),P.classList.remove("bg-auctionBlue")}),fs(),Bs()};f("location")===null&&b("location","/semester-project-2-olemartin/");document.querySelector("h1").addEventListener("click",()=>{I("/semester-project-2-olemartin/")});document.addEventListener("click",t=>{t.target.tagName==="A"&&t.target.origin===location.origin&&(t.preventDefault(),window.history.replaceState({},null,t.target.href),window.history.go(),f("location")!==t.target.href&&I(t.target.href.substring(t.target.href.lastIndexOf("/")+1,t.target.href.length)),et(),Yt(),_t(),Zt())});et();Yt();_t();Zt();
