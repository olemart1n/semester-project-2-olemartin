(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const ke=document.querySelector("#nav-link-1"),K=document.querySelector("#nav-link-2"),Kt=()=>{ke.textContent="Profile",ke.href="/semester-project-2-olemartin/home",K.addEventListener("click",()=>localStorage.clear()),K.href="/semester-project-2-olemartin/",K.textContent="Logout",document.title="Feed | AuctionHouse"},f=e=>{try{return JSON.parse(localStorage.getItem(e))}catch{return null}},Qt=e=>localStorage.removeItem(e),b=(e,r)=>{localStorage.setItem(e,JSON.stringify(r))},I=e=>{localStorage.removeItem("location"),localStorage.setItem("location",JSON.stringify(e))},L={base:"https://api.noroff.dev/api/v1/auction/",register:"auth/register",login:"auth/login",account:"profiles/"+f("name")+"?_listings=true",listings:"listings",profiles:"profiles",editAvatar:"profiles/"+f("name")+"/media"},{base:Re}=L,j={"Content-Type":"application/json",Authorization:`Bearer ${f("auctionToken")}`},v={registerLogin:{method:"POST",headers:{"Content-Type":"application/json"},body:{}},getWithJwt:{method:"GET",headers:j},entry:{method:"POST",headers:j,body:{}},update:{method:"PUT",headers:j,body:{}},deleteOpt:{method:"DELETE",headers:j},react:{method:"PUT",headers:{Authorization:`Bearer ${localStorage.getItem("socialToken")}`}}},p=async(e,r)=>{try{return await(await fetch(Re+e,r)).json()}catch(t){console.error(t)}},n=(e,r)=>{const t=document.createElement(e);for(const o in r)t.setAttribute(o,r[o]);return t},Pe=n("div",{class:"mx-auto w-full mt-15  md:mx-auto md:w-1/2"}),_=n("form",{class:"mt-8 space-y-6 flex flex-col justify-center",method:"POST"}),le=_.cloneNode(!0),Y=n("div",{class:""}),Xt=n("input",{class:"bg-logoBg relative block w-full appearance-none border border-auctionBlue px-3 py-2 focus:outline-auctionBrown",type:"email",placeholder:"email",name:"email",pattern:"^[\\w\\-.]+@(stud.)?noroff.no$",title:"use a @stud.noroff.no mail-adress",required:"required"}),Je=Y.cloneNode(!0);Y.append(Xt);const Zt=n("input",{class:"bg-logoBg relative block w-full appearance-none border border-auctionBlue px-3 py-2 focus:outline-auctionBrown",title:"uppercase, lowercase and (_) allowed",placeholder:"name",type:"text",name:"name",pattern:"[\\w]+$"}),en=Y.cloneNode(!0);Je.append(Zt);const de=n("div",{class:""}),tn=n("input",{class:"bg-logoBg relative block w-full appearance-none border border-auctionBlue px-3 py-2 focus:outline-auctionBrown",type:"password",placeholder:"password",name:"password",minlength:"8",required:"required"});de.append(tn);const nn=de.cloneNode(!0),ue=n("button",{type:"submit",class:"bg-auctionBlue text-almostWhite p-1  rounded-sm  mx-auto"});ue.innerHTML="Login";const Ue=ue.cloneNode(!0);Ue.innerHTML="Register";const V=n("div",{class:"bg-auctionBlue rounded text-center hidden",id:"login-success-alert"}),me=V.cloneNode(!0);me.innerHTML="Account successfully created";V.innerHTML="Login successful";const N=n("div",{class:"bg-auctionRed rounded text-center hidden",id:"login-warning-alert"});_.append(Y,de,ue,V,N);const _e=n("div",{class:"flex flex-col items-center justify-between mt-3"}),Ye=n("span",{class:"text-auctionGrey mx-auto"});Ye.innerHTML="OR";const sn=n("div",{class:"text-md mt-5 mx-auto"}),pe=n("a",{class:"text-almostWhite bg-auctionGrey opacity-50 p-1 ml-1 rounded-sm hover:text-indigo-500",href:"/semester-project-2-olemartin/register"});pe.innerHTML="Create an accocunt";sn.append(pe);_e.append(Ye,pe);Pe.append(_,_e);const Ve=n("div",{class:"mx-auto w-full mt-15  md:mx-auto md:w-1/2"}),Z=N.cloneNode(!0);le.append(Je,en,nn,Ue,me,Z);Ve.append(le);const{login:on}=L,{registerLogin:qe}=v,rn=()=>{_.addEventListener("submit",e=>{e.preventDefault();const r=new FormData(e.currentTarget),t=Object.fromEntries(r.entries()),{email:o}=t;qe.body=JSON.stringify(t),p(on,qe).then(s=>{if(s.email===o){const{name:i,email:a,credits:l,avatar:c,accessToken:u}=s;console.log(s),V.classList.remove("hidden"),b("auctionToken",u),b("name",i),b("credits",l),b("email",a),b("avatar",c),I("/semester-project-2-olemartin/"),setTimeout(()=>{window.location.replace("/semester-project-2-olemartin/")},2e3)}else s.statusCode===401&&(N.classList.remove("hidden"),N.textContent=s.errors[0].message)})})},{register:an,login:cn}=L,{registerLogin:$}=v,ln=()=>{le.addEventListener("submit",e=>{e.preventDefault();const r=new FormData(e.currentTarget),t=Object.fromEntries(r.entries()),{name:o}=t;$.body=JSON.stringify(t),console.log($.body),p(an,$).then(s=>{s.name===o?(console.log(s),me.classList.remove("hidden"),setTimeout(()=>{p(cn,$).then(i=>{const{name:a,email:l,credits:c,avatar:u,accessToken:d}=i;b("auctionToken",d),b("name",a),b("credits",c),b("email",l),b("avatar",u),I("/semester-project-2-olemartin/"),setTimeout(()=>{window.location.replace("/semester-project-2-olemartin/")},2e3)})},2e3)):s.status==="Bad Request"&&(Z.classList.remove("hidden"),Z.textContent=s.errors[0].message)})})},k=()=>!(localStorage.getItem("auctionToken")===null||localStorage.getItem("auctionToken")==="undefined"),ze=document.querySelector("#navWithBar"),dn=document.querySelector("#bar"),un=document.querySelector("#zoomglass"),Ke=document.querySelector("#navWithSearch"),Qe=document.querySelector("#filters"),Xe=()=>{dn.addEventListener("click",e=>{e.stopImmediatePropagation(),ze.classList.toggle("hidden"),Qe.classList.add("hidden"),Ke.classList.add("hidden")})},Ze=()=>{un.addEventListener("click",e=>{e.stopImmediatePropagation(),Ke.classList.toggle("hidden"),ze.classList.add("hidden"),Qe.classList.toggle("hidden")})},mn=document.querySelector("#itemContainer"),pn=()=>{mn.insertAdjacentElement("beforeend",Pe)},gn=document.querySelector("#itemContainer"),fn=()=>{gn.insertAdjacentElement("beforeend",Ve)},Ie=window.location.href,bn=()=>{Ie.includes("login")?(pn(),rn()):Ie.includes("register")?(fn(),ln()):k()===!0&&(Xe(),Ze(),Kt())},ge=()=>{document.querySelectorAll(".fa-expand").forEach(r=>{r.addEventListener("click",t=>{const o=document.createElement("div");o.setAttribute("class","modal"),document.querySelector("main").append(o);const i=t.currentTarget.nextElementSibling.nextElementSibling.cloneNode(!0);o.append(i),o.addEventListener("click",()=>{document.querySelector(".modal").remove()})})})},et=1e3,F=et*60,q=F*60,tt=q*24,h=e=>{const r=new Date(e),t=new Date;return r-t},hn=(e,r)=>{const t=Math.floor(h(e)%tt/q);let o;return r.length>0?o=r[r.length-1].amount:o="0",t<0?'<span class="bg-auctionRed text-auctionGrey">SOLD</span>':"<span>"+t+" hours left</span><span>Bid:"+o+"$</span>"},xn=(e,r)=>{const t=Math.floor(h(e)%q/F);let o;return r.length>0?o=r[r.length-1].amount:o="0",t<0?'<span class="bg-auctionRed text-auctionGrey">SOLD</span>':"<span>"+t+" min left</span><span>Bid:"+o+"$</span>"},vn=e=>{let r=[...e];for(let t=0;t<r.length;t++){let o=!1;for(let s=0;s<r.length;s++)if(r[s]>r[s+1]){let i=r[s];r[s]=r[s+1],r[s+1]=i,o=!0}if(!o)return r}return r},ee=e=>`
  <div
    class="relative aspect-square lg:aspect-square flex flex-col items-center mb-2 shrink justify-between bg-almostWhite overflow-auto hover:overflow-scrollborder-5">
    <i class="absolute fa-sharp fa-solid fa-expand top-5 right-5 text-black fa-lg" id="${e.id}"></i>
    <p class="absolute text-almostWhite p-1 bg-auctionBrown  left-0 bottom-20">${e.title}</p>
    <img 
      src="${e.media[0]}"
      alt="" class="itemImage object-top  object-cover h-2/3 shrink min-w-full img${e.id}">
    <div class="flex text-auctionBlue min-w-full justify-around">
    <div class="flex flex-col m-0 p-0">
    ${hn(e.endsAt,e.bids)}
    </div>
    <a href="/semester-project-2-olemartin/item?id=${e.id}" class="bg-auctionGrey p-1 mb-5 rounded-sm text-almostWhite">view item</a>
    </div>
  </div>
    `,yn=document.querySelector("#listingsFeed"),Ln=async e=>{await p("listings?_bids=true&sort=created&sortOrder=desc").then(r=>{const t=r.filter(o=>o.bids.length>0);for(let o=0;o<t.length;o++){const s=t[o];if(o===10)break;yn.insertAdjacentHTML("beforeend",ee(s))}}),ge()},nt=(e,r)=>{const t=document.querySelector(".counterBox"+e),o=n("div",{class:"time flex flex-col"}),s=n("div",{class:"time flex flex-col"}),i=n("div",{class:"time flex flex-col"}),a=n("h2",{class:"mx-auto text-auctionRed"}),l=n("h2",{class:"mx-auto text-auctionRed"}),c=n("h2",{class:"mx-auto text-auctionRed"}),u=n("small",{class:"mx-auto text-auctionRed"}),d=n("small",{class:"mx-auto text-auctionRed"}),x=n("small",{class:"mx-auto text-auctionRed"});u.innerHTML="hours",d.innerHTML="minutes",x.innerHTML="seconds",o.append(a),o.append(u),s.append(l),s.append(d),i.append(c),i.append(x),t.append(o),t.append(s),t.append(i),setInterval(()=>{c.innerHTML=Math.floor(h(r)%F/et),l.innerHTML=Math.floor(h(r)%q/F),a.innerHTML=Math.floor(h(r)%tt/q)},1e3)},wn=(e,r,t)=>{e.forEach((o,s)=>{const i=n("button",{class:"border bg-auctionBlue aspect-square flex h-7 mx-3 place-content-center items-center border-2 border-almostWhite drop-shadow-md font-bold"});i.innerHTML=s+1,t.append(i),i.addEventListener("click",l=>{document.querySelector(".bg-auctionBlue").classList.add("bg-slate-400"),document.querySelector(".bg-auctionBlue").classList.remove("bg-auctionBlue"),l.currentTarget.classList.remove("bg-slate-400"),l.currentTarget.classList.add("bg-auctionBlue"),document.querySelector(".currentImg").classList.add("hidden"),document.querySelector(".currentImg").classList.remove("currentImg"),document.getElementById(l.currentTarget.innerHTML).classList.remove("hidden"),document.getElementById(l.currentTarget.innerHTML).classList.add("currentImg")});const a=n("img",{class:" object-top  object-cover h-2/3 shrink w-4/5 mx-auto currentImg aspect-square drop-shadow-md hidden",id:s+1});s===0&&a.classList.remove("hidden"),a.src=o,r.append(a),s!==0&&i.classList.add("bg-slate-400")})},{entry:Ae}=v,Tn=(e,r)=>{const t=new FormData(e.currentTarget),o=Object.fromEntries(t.entries()),{amount:s}=o;Ae.body=JSON.stringify({amount:Number(s)}),console.log(o),console.log(r),p(`listings/${r}/bids`,Ae).then(l=>{console.log(l)});const a=f("credits")-Number(s);b("credits",a)},Hn=(e,r,t,o,s,i,a)=>{e.addEventListener("click",l=>{const c=document.createElement("div");c.setAttribute("class","modal"),c.classList.add("bg-auctionGrey"),document.querySelector("main").append(c);const u=w;c.append(u),st.innerHTML=r,at.innerHTML="Your bid: "+t+"$",ot.src=i,rt.innerHTML="<span class='underline underline-offset-2 '>current status</span>"+xn(o,s),it.innerHTML="Your credits "+f("credits")+"$",ct.value=t,fe.addEventListener("click",()=>{document.querySelector(".modal").remove()}),document.getElementById("modalSubmit").addEventListener("submit",d=>{d.preventDefault(),d.stopImmediatePropagation(),Tn(d,a),te.classList.remove("bg-orange-300"),te.classList.add("bg-green-200"),setTimeout(()=>{document.location.replace("/semester-project-2-olemartin/")},1500)})})},w=n("form",{class:"bg-almostWhite w-4/5 md:w-1/2 h-2/3 mx-auto justify-around flex flex-col my-2 p-5 relative bg-auctionWhite",id:"modalSubmit"}),fe=n("i",{class:" text-auctionRed absolute p-4 aspect-square right-0 top-0 h-7"});fe.innerHTML="<i class='fa-solid fa-xmark fa-xl'></i>";const st=n("h2",{class:"text-logoBg font-bold w-full text-xl mx-auto my-2 p-1 flex place-content-center "}),ot=n("img",{class:"object-top  object-cover h-2/3 shrink w-4/5 mx-auto currentImg aspect-square drop-shadow-md"}),rt=n("h4",{class:" py-3 mx-auto text-lg flex place-content-center flex-col text-logoBg font-bold"}),it=n("h4",{class:"py-3 absolute left-0 top-1  text-logoBg font-bold"}),at=n("h3",{class:"w-full py-3 mx-auto text-lg flex place-content-center text-logoBg font-bold"}),ct=n("input",{id:"bidInput",name:"amount",type:"number",class:"bg-almostWhite border border-2 w-10 bg-white text-auctionGrey hidden",placeholder:"$"}),te=n("input",{type:"submit",value:"Confirm",class:"border text-lg font-bold border-radius-sm bg-orange-300 text-auctionBrown py-2 px-4"});w.append(st);w.append(fe);w.append(ot);w.append(rt);w.append(it);w.append(at);w.append(ct);w.append(te);n("input",{type:"submit",value:"Confirm",class:"border border-radius-sm bg-white text-auctionBlue px-2"});n("div",{class:"w-1/2 shrink flex justify-end p-2 gap-1"});const Bn=n("label",{for:"bidInput",class:" text-auctionBrown text-base w-1/2 flex place-content-center items-center"});Bn.textContent="Place a bid";const Sn=(e,r,t,o,s,i,a,l)=>{e.addEventListener("keyup",c=>{c.stopImmediatePropagation();const u=c.currentTarget.value;u-1<r?(t.classList.remove("bg-white"),t.classList.add("bg-red-200"),t.setAttribute("disabled","disabled"),e.setAttribute("title","amount to low")):(t.classList.add("bg-white"),t.classList.remove("bg-red-200"),t.removeAttribute("disabled"),e.removeAttribute("title"),Hn(t,o,u,s,i,a,l))})},lt=e=>{e.addEventListener("click",()=>{window.location.href="/semester-project-2-olemartin/",I("/semester-project-2-olemartin/")}),e.innerHTML="&#x2190; back"},Mn=(e,r,t)=>{t.length===0&&(r.remove(),e.remove()),t.forEach(o=>{r.insertAdjacentHTML("beforeend",`
        <div class="w-full text-auctionGrey flex">
        <p class="w-full text-auctionGrey text-center">${o.bidderName}</p>
        <p class="w-full text-auctionGrey text-center">${o.amount} $</p>
        </div>
        `)}),e.addEventListener("click",o=>{r.classList.toggle("hidden")})},En=n("div",{class:"counterBox w-full grid grid-cols-3  my-5 p-0"}),dt=n("p",{class:"text-auctionGrey"}),ne=n("p",{class:"text-auctionGrey"}),ut=n("div",{class:"w-full bg-green-200 flex justify-around md:w-3/4 mx-auto my-2  flex-wrap "});ut.append(dt,ne);const be=n("button",{class:"px-1 mx-auto text-auctionGrey rounded-sm text-sm bg-auctionYellow mx-auto"});be.innerHTML="View all bids &darr;";const mt=n("div",{class:"text-auctionGrey w-full hidden bg-auctionYellow w-1/2 mx-auto",id:"bid-section"}),pt=n("input",{id:"bidInput",name:"amount",type:"number",class:"bg-almostWhite border border-2 w-10 bg-white text-auctionGrey",placeholder:"$"}),gt=n("input",{type:"button",value:"SUBMIT",class:"border border-radius-sm bg-white text-auctionBlue px-2"}),he=n("div",{class:"w-1/2 shrink flex justify-end p-2 gap-1"}),xe=n("label",{for:"bidInput",class:" text-auctionBrown text-base w-1/2 flex place-content-center items-center"});xe.textContent="Place a bid";const ft=n("div",{class:"bg-auctionBlue w-full bg-opacity-50 md:w-3/4 mx-auto flex my-2 p-1"}),bt=n("div",{class:"relative flex flex-col justify-between bg-almostWhite p-3"}),D=n("div",{class:""}),ht=n("h1",{class:"text-auctionBlue block text-xl mx-auto flex place-content-center"}),se=n("p",{class:"text-auctionBrown mx-auto"}),ve=n("div",{class:"flex place-content-center align-center my-5 flex-wrap"}),xt=n("small",{class:"text-auctionGrey w-full flex place-content-center"});xt.innerHTML="images";ve.append(xt);const vt=n("div",{class:"bg-white p-5 mx-auto flex flex-col   md:w-4/5 border border-auctionBrown rounded-lg drop-shadow-sm my-10"});bt.append(se,vt);const ye=n("div",{class:"mx-auto my-5 md:w-4/5 flex flex-wrap divide-x divide-slate-200"}),yt=n("h3",{class:"text-md text-auctionBlue w-full"});yt.innerHTML="Description";const Lt=n("p",{class:"text-auctionGrey w-1/2 p-1"});ye.append(yt);const wt=n("p",{class:"text-auctionGrey w-1/2 p-1"});ye.append(Lt,wt);he.append(pt,gt);ft.append(xe,he);vt.append(ht,ve,D,En,ut,be,mt,ft,ye);const je=document.querySelector("#itemContainer"),kn=document.querySelector("#listingsFeed"),qn=document.querySelector("main"),In=document.querySelector("#filters"),$e=document.querySelector("#listingHeader"),An=()=>{kn.innerHTML="",je.innerHTML="",$e.innerHTML="",In.remove(),document.title="Item | AuctionHouse",qn.classList.remove("bg-auctionBg");const r=`listings/${f("location").substring(8)}?_seller=true&_bids=true`;lt($e),je.append(bt),p(r).then(t=>{var a,l;t.media.length>0?wn(t.media,D,ve):(D.innerHTML="No images added to this listing",D.classList.add("text-auctionGrey"));const o=t.endsAt;ht.innerHTML=t.title,k()?se.innerHTML=`<a href="/semester-project-2-olemartin/user?${t.seller.name}"><span class="text-auctionGrey">seller: </span class="font-bold text-lg">${t.seller.name}</a>`:se.innerHTML=`<a href="#">${t.seller.name} <span class="text-auctionGrey">(log in to visit ) </span></a>`,h(t.endsAt)>0&&nt("",o),dt.innerHTML="Highest bid",t.bids.length>0?ne.innerHTML=t.bids[t.bids.length-1].bidderName+": "+t.bids[t.bids.length-1].amount+"$":ne.innerHTML=0+"$",Lt.innerHTML=t.description,wt.innerHTML="tags: "+t.tags.toString(""),h(t.endsAt)<0&&(he.innerHTML="Not possible to bid on this item");const i=(l=(a=t.bids[t.bids.length-1])==null?void 0:a.amount)!=null?l:0;k()?Sn(pt,i,gt,t.title,t.endsAt,t.bids,t.media[0],t.id):xe.innerHTML="log in to bid",Mn(be,mt,t.bids)})},{entry:Ge}=v,{listings:jn}=L,$n=e=>{const r=new FormData(e.currentTarget),t=Object.fromEntries(r.entries()),{date:o,tags:s,title:i,description:a}=t,c=new Date(o).toJSON();let u=[],d=s.split(",");document.querySelectorAll("[name='media'").forEach(T=>{T.value.length>0&&u.push(T.value)}),Ge.body=JSON.stringify({title:i,description:a,tags:d,media:u,endsAt:c}),p(jn,Ge).then(T=>{console.log(T)})},m=n("form",{class:" hidden mt-8 bg-logoBg p-3 relative flex flex-col justify-center mx-auto md:w-2/3 w-full",id:"newItem",method:"post",required:"required"}),Tt=n("small",{class:"text-almostWhite mx-auto mt-2"});Tt.innerHTML="Title";const Gn=n("input",{class:"bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"text",name:"title",id:"titleInput",placeholder:"Title",required:"required"}),Ht=n("small",{class:"text-almostWhite mx-auto mt-2"});Ht.innerHTML="tags";const Cn=n("input",{class:"bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"text",name:"tags",id:"tagsInput",placeholder:"tags"}),Bt=n("small",{class:"text-almostWhite mx-auto mt-2"});Bt.innerHTML="Description";const Wn=n("input",{class:"bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"text",name:"description",id:"descriptionInput",placeholder:"description"}),St=n("small",{class:"text-almostWhite mx-auto mt-2"});St.innerHTML="Image URL's";const Dn=n("input",{class:"bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"url",name:"media",id:"mediaInput",placeholder:"media URL"}),oe=n("input",{class:"hidden bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"url",name:"media",id:"mediaInput1",placeholder:"media URL",disabled:"disabled"}),re=n("input",{class:"hidden bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"url",name:"media",id:"mediaInput2",placeholder:"media URL",disabled:"disabled"}),ie=n("input",{class:"hidden bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"url",name:"media",id:"mediaInput3",placeholder:"media URL",disabled:"disabled"}),Nn=n("input",{class:"bg-almostWhite mt-2 rounded p-1 text-black py-1",type:"datetime-local",name:"date",id:"dateInput",placeholder:"ends at",required:"required"}),Fn=n("input",{class:"mt-2 rounded-none py-3 bg-auctionBlue",type:"submit",placeholder:"submit"}),Le=n("button",{class:"text-sm p-0 m-0 border rounded-none mx-auto px-1 mt-1",type:"button"});Le.innerHTML="Add photos &#8595";Le.addEventListener("click",e=>{oe.classList.remove("hidden"),re.classList.remove("hidden"),ie.classList.remove("hidden"),oe.removeAttribute("disabled"),re.removeAttribute("disabled"),ie.removeAttribute("disabled"),e.currentTarget.classList.add("hidden")});m.append(Tt);m.append(Gn);m.append(Ht);m.append(Cn);m.append(Bt);m.append(Wn);m.append(St);m.append(Dn);m.append(oe);m.append(re);m.append(ie);m.append(Le);m.append(Nn);m.append(Fn);const{deleteOpt:On}=v,{listings:Rn}=L,Pn=e=>{e.addEventListener("click",()=>{fetch(Re+Rn+"/"+e.id,On),setTimeout(()=>{window.location.reload()},500)})},{update:Ce}=v,{listings:Jn}=L,Un=(e,r)=>{const t=new FormData(e.currentTarget),o=Object.fromEntries(t.entries()),{tags:s,title:i,description:a}=o;let l=[],c=s.split(",");e.currentTarget.querySelectorAll("[name='media'").forEach(d=>{d.value.length>0&&l.push(d.value)}),Ce.body=JSON.stringify({title:i,description:a,tags:c,media:l}),p(Jn+"/"+r,Ce).then(d=>{console.log(d)})},{listings:_n}=L,{getWithJwt:Yn}=v,Vn=e=>{e.addEventListener("click",r=>{r.stopImmediatePropagation();const t=n("i",{class:"fa-solid fa-xmark fa-xl text-almostWhite absolute p-4 aspect-square right-0 top-0 h-7 hover:bg-auctionGreen"});g.append(t),g.classList.remove("hidden"),B.classList.add("modal"),B.classList.remove("hidden");const o=g.dateInput;o.remove();const s=g.querySelector("button");s.remove();const i=g.tags,a=Array.from(g.media);g.querySelectorAll(".hidden").forEach(c=>{c.classList.remove("hidden")}),p(_n+"/"+r.currentTarget.id,Yn).then(c=>{g.title.value=c.title,g.description.value=c.description,c.media.forEach((d,x)=>{a[x].value=d}),i.value=c.tags.join(", ")}),t.addEventListener("click",()=>{t.remove(),g.append(o),g.append(s),g.classList.add("hidden"),B.classList.remove("modal"),B.classList.add("hidden")}),g.addEventListener("submit",c=>{c.preventDefault(),Un(c,e.id),setTimeout(()=>{document.location.replace("/semester-project-2-olemartin/")},1e3)})})},Mt=(e,r=0)=>{let t;return function(...o){clearTimeout(t),t=setTimeout(()=>e.apply(this,o),r)}},{editAvatar:zn}=L,{update:We}=v,Kn=e=>{e.addEventListener("click",r=>{r.stopImmediatePropagation(),H.classList.remove("hidden"),H.classList.add("modal");const t=n("i",{class:"fa-solid fa-xmark fa-xl text-almostWhite absolute p-4 aspect-square right-5 top-5 h-7 hover:bg-auctionGreen"});H.append(E,t);const o=E.media,s=E.avatar;t.addEventListener("click",()=>{H.classList.add("hidden"),H.classList.remove("modal")}),o.addEventListener("input",Mt(i=>{s.src=i.target.value},1e3)),E.addEventListener("submit",i=>{i.preventDefault(),We.body=JSON.stringify({avatar:o.value}),p(zn,We).then(a=>{console.log(a),Qt("avatar"),b("avatar",a.avatar),setTimeout(()=>{document.location.replace("/semester-project-2-olemartin/")},1e3)})})})},Et=n("div",{class:"w-full  lg:w-2/4 sm:w-3/4 self-center flex flex-wrap"}),kt=n("img",{class:"w-1/3 sm:w-1/2 apect-square mx-auto border rounded-lg max-w-lg"}),qt=n("div",{class:"w-2/3 sm:w-1/2 text-auctionGrey sm:grid sm:grid-rows-4 p-2"}),It=n("h2",{class:" text-auctionGrey text-xl "}),we=n("button",{class:"border bg-auctionGrey text-almostWhite h-8 m-0 text-sm w-1/2 self-end"});we.innerHTML="Edit avatar";Kn(we);const At=n("p",{class:" text-auctionGrey"}),jt=n("p",{class:" text-auctionGrey"});qt.append(It,At,jt,we);const $t=n("div",{class:"w-full   my-5"}),Te=n("button",{class:" px-3 py-2 bg-auctionGreen rounded mx-auto border-none w-full"});$t.append(Te,m);Te.innerHTML="Add listing";Et.append(kt,qt,$t);const Gt=n("div",{class:"py-20"}),Ct=n("h2",{class:"text-lg text-auctionGrey "});Ct.innerHTML="Your listings";const Wt=n("div",{class:"w-full flex justify-start"}),O=n("button",{class:"rounded-xl bg-auctionBlue  mx-1 md:w-40 py-1 w-1/4"});O.innerHTML="Acitve";const R=n("button",{class:"rounded-xl bg-logoBg mx-1 py-1 md:w-40 w-1/4  "});R.innerHTML="All";Wt.append(O,R);Gt.append(Ct,Wt);const Q=(e,r,t,o,s)=>{const i=n("div",{class:"w-full grid grid-rows-4 sm:grid-rows-1 sm:grid-cols-4 relative sm:h-40 border rounded border-auctionBrown border-1 my-2"}),a=n("img",{class:"h-20 w-20 aspect-square object-cover m-auto"});a.src=e;const l=n("div",{class:"flex flex-col justify-around"}),c=n("p",{class:"text-auctionGrey m-auto"});c.innerHTML=r;const u=n("p",{class:"text-auctionGrey m-auto"});u.innerHTML=t,l.append(c,u);const d=n("div",{class:"flex flex-col justify-around p-3"}),x=n("button",{class:"bg-auctionBlue text-auctionGrey w-1/2 mx-auto my-1",id:s});Vn(x),x.innerHTML="Update";const T=n("button",{class:"bg-auctionRed text-auctionGrey w-1/2 mx-auto my-1",id:s});T.innerHTML="Delete",Pn(T),d.append(x,T);const Ee=n("div",{class:"flex p-3"}),z=n("a",{class:"text-auctionGrey m-auto bg-veryLightGrey h-1/2 w-full border rounded-lg items-center flex place-content-center"});return z.href=o,z.innerHTML="Visit",Ee.append(z),i.append(a,l,d,Ee),i},Dt=e=>h(e)<0?"<span class='bg-red-300 bg-opacity-30 p-2 text-auctionGrey'>FINISED</span>":"<span class='bg-auctionGreen bg-opacity-30 p-2 text-auctionGrey'>ACTIVE</span>",Qn=e=>!(h(e)<0),E=n("form",{id:"avatarForm",class:"w-2/3 h-2/3 rounded-sm bg-logoBg flex flex-col align-items-center relative"}),Xn=n("input",{class:" bg-almostWhite my-2 rounded p-1 text-black ",type:"url",name:"media",id:"avatarInput",placeholder:"avatar URL"}),Nt=n("button",{type:"submit",class:"bg-auctionBlue rounded-none w-40 mx-auto my-5"});Nt.innerHTML="Update";const Ft=n("img",{class:"w-1/2 rounded-lg m-2",name:"avatar"});Ft.src=f("avatar");E.append(Ft,Xn,Nt);const De=(e,r,t,o)=>{e.remove(),e.innerHTML="",r.append(e),t.forEach(s=>{e.insertAdjacentElement("beforeend",o(s.media[0],s.title,Dt(s.endsAt),`/semester-project-2-olemartin/item?id=${s.id}`,s.id))})},{account:Zn}=L,{getWithJwt:es}=v,ts=document.querySelector("#listingHeader"),G=document.querySelector("#itemContainer"),C=n("div",{class:""}),B=n("div",{class:"w-full aspect-square hidden"}),g=m.cloneNode(!0),H=n("div",{class:"w-full aspect-square hidden"}),ns=async()=>{document.body.append(B,H),G.classList.add("min-h-screen"),document.title="Profile | AuctionHouse",ts.innerHTML="Your details",g.id="updateForm",B.append(g),G.append(Et,Gt,C);const e=[],r=[];await p(Zn,es).then(t=>{console.log(t),kt.src=t.avatar,It.innerHTML=t.name,At.innerHTML=t.email,jt.innerHTML="Your wallet "+t.credits+"$",t.listings.forEach(o=>{C.insertAdjacentElement("beforeend",Q(o.media[0],o.title,Dt(o.endsAt),`/semester-project-2-olemartin/item?id=${o.id}`,o.id)),Qn(o.endsAt)&&e.push(o),r.push(o)})}),O.append("("+e.length+")"),R.append("("+r.length+")"),O.addEventListener("click",()=>{De(C,G,e,Q)}),R.addEventListener("click",()=>{De(C,G,r,Q)}),Te.addEventListener("click",t=>{m.classList.toggle("hidden")}),m.addEventListener("submit",t=>{t.preventDefault(),$n(t),setTimeout(()=>{document.location.replace("/semester-project-2-olemartin/")},500)})},He=n("div",{class:"w-full flex lg:w-2/4 md:w-3/4 self-center"}),Ot=n("img",{class:"w-1/2 apect-square mx-auto border rounded-lg max-w-lg"}),Rt=n("h2",{class:"w-1/2 mx-auto text-auctionGrey text-xl flex items-center place-content-center"});He.append(Ot);He.append(Rt);const ae=n("div",{class:"py-20"}),Pt=n("h2",{class:"text-lg text-auctionGrey"});ae.append(Pt);const ss=(e,r,t,o)=>{const s=n("a",{class:"w-full grid grid-cols-3 relative h-24 items-center border rounded border-auctionBrown my-2 place-content-center"});s.href=e;const i=n("img",{class:"h-12 w-12 aspect-square object-cover mx-auto"});i.src=r;const a=n("p",{class:"text-auctionGrey"});a.innerHTML=t;const l=n("p",{class:"text-auctionGrey"});return l.innerHTML=o,s.append(i,a,l),s},Ne=e=>h(e)<0?"<span class='bg-red-300 bg-opacity-30 p-2 text-auctionGrey'>FINISED</span>":"<span class='bg-auctionGreen bg-opacity-30 p-2 text-auctionGrey'>ACTIVE</span>",ce=n("div",{class:"py-10"}),Jt=n("h2",{class:"text-lg text-auctionGrey "});ce.append(Jt);const os=(e,r,t)=>{const o=n("a",{class:"w-full grid grid-cols-3 relative h-20 items-center border rounded border-auctionBrown my-2 place-content-center"});o.href=e;const s=n("p",{class:"text-auctionGrey"});s.innerHTML=r;const i=n("p",{class:"text-auctionGrey"});return i.innerHTML=t,o.append(s,"-",i),o},rs=document.querySelector("#itemContainer"),is=document.querySelector("#listingHeader"),{getWithJwt:Fe}=v,as=()=>{lt(is);const e=f("location").substring(5),r=`profiles/${e}?_listings=true `,t=`profiles/${e}/bids?_listings=true`;rs.append(He,ae,ce),p(r,Fe).then(o=>{Ot.src=o.avatar,Rt.innerHTML=o.name,Pt.innerHTML=o.name+"'s listings",o.listings.forEach(s=>{ae.insertAdjacentElement("beforeend",ss(`/semester-project-2-olemartin/item?id=${s.id}`,s.media[0],s.title,Ne(s.endsAt)))})}),p(t,Fe).then(o=>{o.length>0&&(Jt.innerHTML=o[0].bidderName+" made bid's on these listings",o.forEach(s=>{ce.insertAdjacentElement("beforeend",os(`/semester-project-2-olemartin/item?id=${s.listing.id}`,s.listing.title,Ne(s.listing.endsAt)))}))})},cs=()=>{f("location").includes("item")?An():f("location").includes("user")&&k()?as():f("location").includes("home")?ns():document.querySelector("#listingsFeed")&&f("location").includes("semester")&&Ln()},ls=()=>{document.querySelector("#listingsFeed")&&(Xe(),Ze())},P=n("button",{class:"text-almostWhite bg-logoBg w-1/4  rounded-none px-1 border-none mx-auto w-30 enabled:hover:outline-none",id:"filter-link-1"});P.innerHTML="Newest";const J=n("button",{class:"text-almostWhite bg-logoBg w-1/4  rounded-none px-1 border-none mx-auto w-30 enabled:hover:outline-none",id:"filter-link-2"});J.innerHTML="Expiring today";const Be=n("nav",{class:""}),Ut=n("div",{class:"flex self-center"}),_t=n("p",{class:"text-logoBg m-auto"});_t.innerHTML="sort by";const Se=n("div",{class:"flex flex-col md:flex-row md:pb-0 pb-0 gap-2"});Ut.append(_t);Se.append(J);Se.append(P);Be.append(Ut);Be.append(Se);const U=n("button",{class:"px-5 border border-1 text-logoBg py-2 mx-auto block"});U.innerHTML="Next";const S=n("button",{class:"border border-logoBg py-1 mx-2 w-20 enabled:hover:outline-none text-black"});S.innerHTML="titles";const M=n("button",{class:"border border-logoBg py-1 mx-2 w-20 enabled:hover:outline-none text-black"});M.innerHTML="users";const A=n("button",{class:"border border-logoBg py-1 mx-2 w-20 enabled:hover:outline-none text-black"});A.innerHTML="tags";const Yt=(e,r,t,o)=>{const s=n("a",{class:"w-full grid grid-cols-3 relative h-24 items-center border rounded border-auctionBrown my-2 place-content-center"});s.href=e;const i=n("img",{class:"h-12 w-12 aspect-square object-cover mx-auto"});i.src=r;const a=n("p",{class:"text-auctionGrey"});a.innerHTML=t;const l=n("p",{class:"text-auctionGrey"});return l.innerHTML=o,s.append(i,a,l),s},Vt=e=>h(e)<0?"<span class='bg-red-300 bg-opacity-30 p-2 text-auctionGrey'>FINISED</span>":"<span class='bg-auctionGreen bg-opacity-30 p-2 text-auctionGrey'>ACTIVE</span>",ds=(e,r,t)=>{const o=n("a",{class:"w-full grid grid-cols-2 relative h-24 items-center border rounded border-auctionBrown my-2 place-content-center"});o.href="/semester-project-2-olemartin/user/"+e;const s=n("img",{class:"h-12 w-12 aspect-square object-cover mx-auto"});s.src=r;const i=n("p",{class:"text-auctionGrey"});return i.innerHTML=t,o.append(s,i),o},us=document.querySelector("#listingsFeed"),ms=document.querySelector("#itemContainer"),ps=document.querySelector("#searchForm"),W=document.querySelector("#filters"),gs=()=>{ps.addEventListener("input",()=>{us.innerHTML="",ms.innerHTML=`<div class="h-screen flex items-start place-content-center">
            <div class="relative w-24 h-24 animate-spin rounded-full bg-gradient-to-r from-auctionGreen via-logoBg to-auctionBlue ">
            <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-20 h-20 bg-gray-200 rounded-full border-2"></div>
            </div>
            </div>`,W.innerHTML="",W.append(S,A,M),W.classList.remove("md:columns-2","md:block"),W.classList.add("md:flex","place-content-center")})},X=document.querySelector("#listingsFeed");document.querySelector("#filter-link-1");const fs=document.querySelector("#listingHeader"),zt=async(e,r)=>{let t=e;X.innerHTML="",fs.innerHTML="Recently added items",await p("listings?_bids=true&sort=created&sortOrder=desc").then(s=>{const i=s.filter(a=>a.media[0]!==void 0);for(t;t<r;t++){const a=i[t];ee(a),X.insertAdjacentHTML("beforeend",ee(a))}}),ge(),X.insertAdjacentElement("afterend",U);let o=0;U.addEventListener("click",s=>{s.stopImmediatePropagation(),o++,zt(14*o,28*o)})},bs=e=>`
    <div
    class="relative aspect-square lg:aspect-square flex flex-col items-center mb-2 shrink justify-between bg-almostWhite overflow-auto hover:overflow-scrollborder-5">
    <i class="absolute fa-sharp fa-solid fa-expand top-5 right-5 text-black fa-lg" id="${e.id}"></i>
    <p class="absolute text-almostWhite p-1 bg-auctionBrown  left-0 bottom-20">${e.title}</p>
    <img 
      src="${e.media[0]}"
      alt="" class="itemImage object-top  object-cover h-2/3 shrink min-w-full img${e.id}">
    <div class="flex text-auctionBlue min-w-full justify-around counterB">
    <div class="grid grid-cols-3  m-0 p-0 w-1/2 counterBox${e.id}">
    </div>
    <a href="/semester-project-2-olemartin/item?id=${e.id}" class="bg-auctionGrey p-1 mb-5 rounded-sm text-almostWhite">view item</a>
    </div>
  </div>
    `,Oe=document.querySelector("#listingsFeed"),hs=document.querySelector("#listingHeader"),xs=async(e,r)=>{let t=e;Oe.innerHTML="",hs.innerHTML="Expires today",await p("listings?_bids=true&sort=created&sortOrder=desc").then(o=>{const s=o.filter(c=>h(c.endsAt)<864e5&&h(c.endsAt)>0),i=[];s.forEach(c=>{i.push(c.endsAt)});const a=vn(i),l=[];for(let c=0;c<a.length;c++){const u=a[c];for(let d=0;d<s.length;d++){let x=s[d];s[d].endsAt===u&&!l.includes(s[d])&&l.push(x)}}for(t=0;t<r;t++){const c=l[t];if(c===void 0)break;const u=c.endsAt,d=c.id;Oe.insertAdjacentHTML("beforeend",bs(c)),nt(d,u)}}),ge()},y=document.querySelector("#itemContainer"),Me=document.querySelector("#listingHeader"),vs=e=>{S.addEventListener("click",r=>{r.currentTarget.classList.add("bg-auctionBlue"),A.classList.remove("bg-auctionBlue"),M.classList.remove("bg-auctionBlue"),y.innerHTML="",setTimeout(()=>{(y.innerHTML.includes("-translate-x-1/2")||y.innerHTML==="")&&(y.innerHTML="<p class='font-bold text-black mx-auto'>No results. <a href='./'>Go back</a></p>")},1500),e.forEach(t=>{y.insertAdjacentElement("beforeend",Yt(`/semester-project-2-olemartin/item?id=${t.id}`,t.media[0],t.title,Vt(t.endsAt)))})}),S.click(),Me.innerHTML="Search by title"},ys=e=>{A.addEventListener("click",r=>{Me.innerHTML="Search by tags",r.currentTarget.classList.add("bg-auctionBlue"),S.classList.remove("bg-auctionBlue"),M.classList.remove("bg-auctionBlue"),y.innerHTML="",e.forEach(t=>{y.insertAdjacentElement("beforeend",Yt(`/semester-project-2-olemartin/item?id=${t.id}`,t.media[0],t.title,Vt(t.endsAt)))})})},Ls=e=>{M.addEventListener("click",r=>{Me.innerHTML="Search by user",r.currentTarget.classList.add("bg-auctionBlue"),S.classList.remove("bg-auctionBlue"),A.classList.remove("bg-auctionBlue"),y.innerHTML="",e.forEach(t=>{y.insertAdjacentElement("beforeend",ds(t.name,t.avatar,t.name))})})},{getWithJwt:ws}=v,Ts=document.querySelector("#searchForm"),Hs=()=>{Ts.addEventListener("input",Mt(e=>{Bs(e)},1e3))},Bs=e=>{p("listings").then(r=>{const t=r.filter(s=>Boolean(s.tags.map(a=>a.toLowerCase()).filter(a=>a.includes(e.target.value)).length)),o=r.filter(s=>s.title.includes(e.target.value));vs(o),ys(t)}),k()?p("profiles",ws).then(r=>{const t=r.filter(o=>o.name.includes(e.target.value));Ls(t),console.log(r)}):M.remove()},Ss=document.querySelector("#filters"),Ms=()=>{Ss.insertAdjacentElement("beforeend",Be),P.addEventListener("click",e=>{document.querySelector("#itemContainer")&&document.querySelector("#itemContainer").remove(),zt(0,14),e.currentTarget.classList.add("bg-auctionBlue"),J.classList.remove("bg-auctionBlue")}),J.addEventListener("click",e=>{U.remove(),document.querySelector("#itemContainer")&&document.querySelector("#itemContainer").remove(),xs(0,14),e.currentTarget.classList.add("bg-auctionBlue"),P.classList.remove("bg-auctionBlue")}),gs(),Hs()};f("location")===null&&b("location","/semester-project-2-olemartin/");document.querySelector("h1").addEventListener("click",()=>{I("/semester-project-2-olemartin/")});document.addEventListener("click",e=>{e.target.tagName==="A"&&e.target.origin===location.origin&&(e.preventDefault(),window.history.replaceState({},null,e.target.href),window.history.go(),f("location")!==e.target.href&&I(e.target.href.substring(e.target.href.lastIndexOf("/")+1,e.target.href.length)),console.log(e.target))});bn();ls();cs();Ms();
